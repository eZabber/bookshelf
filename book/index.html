<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>My BookShelf</title>
  
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
  
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <header>
    <button id="menu-btn" aria-label="Open menu">‚ò∞</button>
    <h1 class="app-title">üìö <span class="title-my">My</span> <span class="title-main">BookShelf</span></h1>
    <div id="sync-wrapper">
      <div id="sync-dot" title="Sync Status"></div>
      <div style="width: 10px;"></div>
    </div>
  </header>

  <div id="menu-overlay"></div>
  <div id="side-menu">
    <h2 class="menu-title">Settings & Filters</h2>
    <div class="menu-section">
        <button id="auth-btn" disabled>Sign In with Google</button>
        <div style="margin-top:10px; font-size:0.8rem; text-align:center;">
            <a id="sheet-link" target="_blank" href="#" style="display:none; color:var(--accent);">‚ÜóÔ∏è Open Google Sheet</a>
        </div>
    </div>
    
    <div class="menu-section">
      <span class="menu-title">Shelves</span>
      <div class="shelf-counters">
        <span id="count-read">Read: 0</span>
        <span id="count-wishlist">Wish: 0</span>
        <span id="count-loans">Loans: 0</span>
      </div>
    </div>

    <div class="menu-section">
        <label class="menu-title">Display</label>
        <div class="menu-row">
            <span>Dark Mode</span>
            <label class="toggle-switch">
                <input type="checkbox" id="dark-mode-toggle">
                <span class="slider"></span>
            </label>
        </div>
    </div>

    <div class="menu-section">
        <label class="menu-title">Filter Books</label>
        <input type="text" id="filter-text" class="menu-input" placeholder="Title, Author, or ISBN">
        
        <div class="filter-grid">
            <div class="filter-field">
                <label for="filter-year">Year</label>
                <input type="text" id="filter-year" class="menu-input" placeholder="YYYY" inputmode="numeric" maxlength="4">
            </div>
            <div class="filter-field">
                <label for="filter-month">Month</label>
                <select id="filter-month" class="menu-select">
                    <option value="">All</option>
                    <option value="01">Jan</option><option value="02">Feb</option><option value="03">Mar</option>
                    <option value="04">Apr</option><option value="05">May</option><option value="06">Jun</option>
                    <option value="07">Jul</option><option value="08">Aug</option><option value="09">Sep</option>
                    <option value="10">Oct</option><option value="11">Nov</option><option value="12">Dec</option>
                </select>
            </div>
        </div>
        
        <div class="menu-actions">
            <button class="btn-sm" onclick="clearFilters()" style="width:100%;">Clear Filters</button>
        </div>
    </div>

    <div class="menu-section">
        <button id="reset-btn" class="btn-sm btn-del" style="width:100%;">Reset App Data</button>
    </div>
  </div>

  <div id="debug-log"></div>

  <div class="tabs">
    <div class="tab active" id="tab-read">Read</div>
    <div class="tab" id="tab-wishlist">Wishlist</div>
    <div class="tab" id="tab-loans">Loans</div>
  </div>

  <div class="controls">
    <input type="text" id="isbn-input" placeholder="Search ISBN, Title, Author‚Ä¶" />
    <button class="action-btn" id="btn-add">Add</button>
    <button class="action-btn scan-btn" id="btn-scan">üì∑</button>
  </div>

  <div id="reader-container">
    <div id="reader"></div>
    <button id="btn-stop-camera" style="width:100%;padding:10px;margin-top:10px;background:var(--card);border:1px solid var(--border);border-radius:4px;color:var(--text);font-weight:500;">Stop Camera</button>
  </div>

  <ul id="book-list"></ul>

  <footer class="app-footer">
    Created by <strong>eZabber</strong> &copy; <span id="year"></span>
  </footer>

  <div id="modal-overlay">
    <div class="modal-content">
      <img id="modal-img" class="modal-cover" src="" alt="cover" onerror="this.style.display='none'"/>
      <div id="modal-title" class="modal-title"></div>
      <div id="modal-author" class="modal-author"></div>
      <div style="font-size:0.8rem; color:var(--meta); margin-bottom:10px; font-family:monospace;" id="modal-isbn"></div>
      
      <div class="modal-input-row" style="justify-content: center; gap: 10px;">
        <span>üéß Storytel / Audio?</span>
        <label class="toggle-switch">
            <input type="checkbox" id="modal-audio-check">
            <span class="slider"></span>
        </label>
      </div>

      <div id="loan-date-row" class="modal-input-row" style="display:none; justify-content:center; gap:10px;">
        <span>üìÖ Return date</span>
        <input type="date" id="modal-return-date" style="padding:6px; border-radius:6px; border:1px solid var(--border); background:var(--card); color:var(--text);">
      </div>

      <div class="modal-btns">
        <button class="btn-choice btn-primary" id="modal-add-read">Add to Read</button>
        <button class="btn-choice btn-primary" id="modal-add-wish" style="background:var(--accent);">Add to Wishlist</button>
        <button class="btn-choice btn-loan" id="modal-add-loan">Add to Loans</button>
        <button class="btn-choice btn-cancel" id="modal-cancel">Cancel</button>
      </div>
    </div>
  </div>

  <script src="script.js"></script>

  <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
  <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>

</body>
</html>
