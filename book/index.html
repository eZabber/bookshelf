<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>My BookShelf</title>
  
  <link rel="stylesheet" href="style.css">
  
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
</head>

<body>

  <header>
    <button id="menu-btn" aria-label="Open menu">â˜°</button>
    <h1 class="app-title">ğŸ“š <span class="title-my">My</span> <span class="title-main">BookShelf</span></h1>
    <div id="sync-wrapper">
      <div id="sync-dot" title="Sync Status"></div>
      <div style="width: 10px;"></div>
    </div>
  </header>

  <div id="menu-overlay"></div>
  <div id="side-menu">
    
    <h2 class="menu-title" id="menu-settings" style="margin-top:0;">Settings & Filters</h2>

    <div class="menu-section">
        <span class="menu-title" id="menu-lang" style="font-size: 0.9rem;">Language</span>
        <select id="language-select" class="menu-select">
            <option value="en">English ğŸ‡¬ğŸ‡§</option>
            <option value="fi">Suomi ğŸ‡«ğŸ‡®</option>
            <option value="et">Eesti ğŸ‡ªğŸ‡ª</option>
        </select>
    </div>

    <div class="menu-section">
        <button id="auth-btn" disabled>Sign In with Google</button>
        <div style="margin-top:10px; font-size:0.8rem; text-align:center;">
            <a id="sheet-link" target="_blank" href="#" style="display:none; color:var(--accent);">â†—ï¸ Open Google Sheet</a>
        </div>
    </div>
    
    <div class="menu-section">
      <span class="menu-title" id="menu-shelves">Shelves</span>
      <div class="shelf-counters">
        
        <div class="stat-box">
            <span class="stat-label" id="label-stat-read">Read</span>
            <span id="count-read" class="stat-num">0</span>
        </div>
        
        <div class="stat-box">
            <span class="stat-label" id="label-stat-wish">Wishlist</span>
            <span id="count-wishlist" class="stat-num">0</span>
        </div>
        
        <div class="stat-box">
            <span class="stat-label" id="label-stat-loans">Loans</span>
            <span id="count-loans" class="stat-num">0</span>
        </div>

      </div>
    </div>

    <div class="menu-section">
        <label class="menu-title" id="menu-display">Display</label>
        <div class="menu-row">
            <span id="label-darkmode">Dark Mode</span>
            <label class="toggle-switch">
                <input type="checkbox" id="dark-mode-toggle">
                <span class="slider"></span>
            </label>
        </div>
    </div>

    <div class="menu-section">
        <label class="menu-title" id="menu-filter">Filter Books</label>
        <input type="text" id="filter-text" class="menu-input" placeholder="Title, Author, or ISBN">
        
        <div class="filter-grid">
            <div class="filter-field">
                <label for="filter-year" id="label-year">Year</label>
                <input type="text" id="filter-year" class="menu-input" placeholder="YYYY" inputmode="numeric" maxlength="4">
            </div>
            <div class="filter-field">
                <label for="filter-month" id="label-month">Month</label>
                <select id="filter-month" class="menu-select">
                    <option value="">All</option>
                    <option value="01">01</option><option value="02">02</option><option value="03">03</option>
                    <option value="04">04</option><option value="05">05</option><option value="06">06</option>
                    <option value="07">07</option><option value="08">08</option><option value="09">09</option>
                    <option value="10">10</option><option value="11">11</option><option value="12">12</option>
                </select>
            </div>
        </div>

        <div class="menu-row" style="margin-top:12px;">
            <span id="label-rating">Rating</span>
            <select id="filter-rating" class="menu-select" style="width: 60%;">
                <option value="">All</option>
                <option value="5">5 â˜…</option>
                <option value="4">4 â˜…</option>
                <option value="3">3 â˜…</option>
                <option value="2">2 â˜…</option>
                <option value="1">1 â˜…</option>
            </select>
        </div>
        
        <div class="menu-actions">
            <button class="btn-sm" id="btn-clear-filters" style="width:100%;">Clear Filters</button>
        </div>
    </div>

    <div class="menu-section">
        <button id="reset-btn" class="btn-sm btn-del" style="width:100%;">Reset App Data</button>
    </div>
  </div>

  <div id="debug-log"></div>

  <div class="tabs">
    <div class="tab active" id="tab-read">Read</div>
    <div class="tab" id="tab-wishlist">Wishlist</div>
    <div class="tab" id="tab-loans">Loans</div>
  </div>

  <div class="controls">
    <input type="text" id="isbn-input" placeholder="..." />
    <button class="action-btn" id="btn-add">Add</button>
    <button class="action-btn scan-btn" id="btn-scan">ğŸ“·</button>
  </div>

  <div id="reader-container">
    <div id="reader"></div>
    <button id="btn-stop-camera" style="width:100%;padding:10px;margin-top:10px;background:var(--card);border:1px solid var(--border);border-radius:4px;color:var(--text);font-weight:500;">Stop Camera</button>
  </div>

  <ul id="book-list"></ul>

  <footer class="app-footer">
    Created by <strong>eZabber</strong> &copy; <span id="year"></span>
  </footer>

  <div id="modal-overlay">
    <div class="modal-content">
      <img id="modal-img" class="modal-cover" src="" alt="cover" onerror="this.style.display='none'"/>
      <div id="modal-title" class="modal-title"></div>
      <div id="modal-author" class="modal-author"></div>
      <div style="font-size:0.8rem; color:var(--meta); margin-bottom:10px; font-family:monospace;" id="modal-isbn"></div>
      
      <div class="modal-input-row" style="justify-content: center; gap: 10px;">
        <span id="label-audio">ğŸ§ Audio?</span>
        <label class="toggle-switch">
            <input type="checkbox" id="modal-audio-check">
            <span class="slider"></span>
        </label>
      </div>

      <div id="loan-date-row" class="modal-input-row" style="display:none; justify-content:center; gap:10px;">
        <span id="label-return">ğŸ“… Return</span>
        <input type="date" id="modal-return-date" style="padding:6px; border-radius:6px; border:1px solid var(--border); background:var(--card); color:var(--text);">
      </div>

      <div class="modal-btns">
        <button class="btn-choice btn-primary" id="modal-add-read">Add to Read</button>
        <button class="btn-choice btn-primary" id="modal-add-wish" style="background:var(--accent);">Add to Wishlist</button>
        <button class="btn-choice btn-loan" id="modal-add-loan">Add to Loans</button>
        <button class="btn-choice btn-cancel" id="modal-cancel">Cancel</button>
      </div>
    </div>
  </div>

  <script src="script.js"></script>

  <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
  <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>

</body>
</html>
